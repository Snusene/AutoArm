<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{982D3BEA-756A-417F-8671-E4DEE0EC26AD}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>AutoArm</RootNamespace>
    <AssemblyName>AutoArm</AssemblyName>
    <TargetFrameworkVersion>v4.7.2</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <Deterministic>true</Deterministic>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <UseWinFormsOutOfProcDesigner>True</UseWinFormsOutOfProcDesigner>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <UseWinFormsOutOfProcDesigner>True</UseWinFormsOutOfProcDesigner>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="0Harmony">
      <HintPath>..\..\..\..\..\..\Program Files (x86)\Steam\steamapps\common\RimWorld\RimWorldWin64_Data\net472\0Harmony.dll</HintPath>
    </Reference>
    <Reference Include="Assembly-CSharp">
      <HintPath>..\..\..\..\..\..\Program Files (x86)\Steam\steamapps\common\RimWorld\RimWorldWin64_Data\Managed\Assembly-CSharp.dll</HintPath>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
    <Reference Include="UnityEngine.CoreModule">
      <HintPath>..\..\..\..\..\..\Program Files (x86)\Steam\steamapps\common\RimWorld\RimWorldWin64_Data\Managed\UnityEngine.CoreModule.dll</HintPath>
    </Reference>
    <Reference Include="UnityEngine.IMGUIModule">
      <HintPath>..\..\..\..\..\..\Program Files (x86)\Steam\steamapps\common\RimWorld\RimWorldWin64_Data\Managed\UnityEngine.IMGUIModule.dll</HintPath>
    </Reference>
    <Reference Include="UnityEngine.TextRenderingModule">
      <HintPath>..\..\..\..\..\..\Program Files (x86)\Steam\steamapps\common\RimWorld\RimWorldWin64_Data\Managed\UnityEngine.TextRenderingModule.dll</HintPath>
    </Reference>
    <Reference Include="UnityEngine.UIElementsModule">
      <HintPath>..\..\..\..\..\..\Program Files (x86)\Steam\steamapps\common\RimWorld\RimWorldWin64_Data\Managed\UnityEngine.UIElementsModule.dll</HintPath>
    </Reference>
    <!-- netstandard reference for RimWorld 1.6+ compatibility -->
    <Reference Include="netstandard" Condition="Exists('..\..\..\..\..\..\Program Files (x86)\Steam\steamapps\common\RimWorld\RimWorldWin64_Data\Managed\netstandard.dll')">
      <HintPath>..\..\..\..\..\..\Program Files (x86)\Steam\steamapps\common\RimWorld\RimWorldWin64_Data\Managed\netstandard.dll</HintPath>
      <Private>False</Private>
    </Reference>
    <!-- Alternative path for different Steam installations -->
    <Reference Include="netstandard" Condition="!Exists('..\..\..\..\..\..\Program Files (x86)\Steam\steamapps\common\RimWorld\RimWorldWin64_Data\Managed\netstandard.dll') And Exists('$(RIMWORLD_DIR)\RimWorldWin64_Data\Managed\netstandard.dll')">
      <HintPath>$(RIMWORLD_DIR)\RimWorldWin64_Data\Managed\netstandard.dll</HintPath>
      <Private>False</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Compile Include="Properties\AssemblyInfo.cs" />
    <Compile Include="Source\Caching\GenericCache.cs" />
    <Compile Include="Source\Caching\PawnValidationCache.cs" />
    <Compile Include="Source\Core\AutoArmGameComponent.cs" />
    <Compile Include="Source\Core\AutoArmMod.cs" />
    <Compile Include="Source\Core\AutoArmSettings.cs" />
    <Compile Include="Source\Core\ModInit.cs" />
    <Compile Include="Source\Caching\MemoryCleanupManager.cs" />
    <Compile Include="Source\Caching\WeaponCacheManager.cs" />
    <Compile Include="Source\Caching\WeaponScoreCache.cs" />
    <Compile Include="Source\Compatibility\CECompat.cs" />
    <Compile Include="Source\Compatibility\InfusionCompat.cs" />
    <Compile Include="Source\Compatibility\SimpleSidearmsCompat.cs" />
    <Compile Include="Source\Definitions\VanillaWeaponDefOf.cs" />
    <Compile Include="Source\Definitions\Constants.cs" />
    <Compile Include="Source\Helpers\CleanupHelper.cs" />
    <Compile Include="Source\Helpers\DroppedItemTracker.cs" />
    <Compile Include="Source\Helpers\ForcedWeaponHelper.cs" />
    <Compile Include="Source\Helpers\ForcedWeaponTracker.cs" />
    <Compile Include="Source\Helpers\PerformanceHelper.cs" />
    <Compile Include="Source\Helpers\ValidationHelper.cs" />
    <Compile Include="Source\Jobs\AutoEquipTracker.cs" />
    <Compile Include="Source\Jobs\JobGiverHelpers.cs" />
    <Compile Include="Source\Jobs\JobGiver_PickUpBetterWeapon.cs" />
    <Compile Include="Source\Jobs\JobHelper.cs" />
    <Compile Include="Source\Logging\AutoArmLogger.cs" />
    <Compile Include="Source\Patches\ChildWeaponPatches.cs" />
    <Compile Include="Source\Patches\EquipmentPatches.cs" />
    <Compile Include="Source\Patches\InventoryPatches.cs" />
    <Compile Include="Source\Patches\MapInitPatches.cs" />
    <Compile Include="Source\Patches\OutfitFilterPatches.cs" />
    <Compile Include="Source\Patches\UIPatches.cs" />
    <Compile Include="Source\Patches\WeaponCachePatches.cs" />
    <Compile Include="Source\Testing\Helpers\JobGiverTestExtensions.cs" />
    <Compile Include="Source\Testing\Helpers\JobGiverTestHelper.cs" />
    <Compile Include="Source\Testing\Helpers\TestConstants.cs" />
    <Compile Include="Source\Testing\Helpers\TestValidationHelper.cs" />
    <Compile Include="Source\Testing\PerformanceTestRunner.cs" />
    <Compile Include="Source\Testing\Scenarios\BasicTests.cs" />
    <Compile Include="Source\Testing\Scenarios\CompatibilityTests.cs" />
    <Compile Include="Source\Testing\Scenarios\CoreTests.cs" />
    <Compile Include="Source\Testing\Scenarios\CriticalTests.cs" />
    <Compile Include="Source\Testing\Scenarios\GameplayTests.cs" />
    <Compile Include="Source\Testing\Scenarios\MemoryAndPerformanceTests.cs" />
    <Compile Include="Source\Testing\Scenarios\MiscTests.cs" />
    <Compile Include="Source\Testing\Scenarios\NullSafetyTestFix.cs" />
    <Compile Include="Source\Testing\Scenarios\PawnBehaviorTests.cs" />
    <Compile Include="Source\Testing\Scenarios\PerformanceTests.cs" />
    <Compile Include="Source\Testing\Scenarios\ReflectionAndBypassTests.cs" />
    <Compile Include="Source\Testing\Scenarios\SaveLoadTest.cs" />
    <Compile Include="Source\Testing\Scenarios\SimpleSidearmsAdvancedTests.cs" />
    <Compile Include="Source\Testing\Scenarios\SystemTests.cs" />
    <Compile Include="Source\Testing\Scenarios\TestFixes.cs" />
    <Compile Include="Source\Testing\Scenarios\WeaponTests.cs" />
    <Compile Include="Source\Testing\Helpers\TestHelpers.cs" />
    <Compile Include="Source\Testing\TestInterfaces.cs" />
    <Compile Include="Source\Testing\TestRunner.cs" />
    <Compile Include="Source\Testing\TestRunnerFix.cs" />
    <Compile Include="Source\Testing\Scenarios\TestSimpleSidearmsValidation.cs" />
    <Compile Include="Source\Testing\TestSuites.cs" />
    <Compile Include="Source\Core\WeaponBlacklist.cs" />
    <Compile Include="Source\Core\WeaponScoringHelper.cs" />
    <Compile Include="Source\Core\WeaponValidation.cs" />
    <Compile Include="Source\UI\WeaponTabInjector.cs" />
  </ItemGroup>
  <ItemGroup>
    <Content Include=".gitignore" />
    <Content Include="About\About.xml" />
    <Content Include="bin\Debug\AutoArm.dll" />
    <Content Include="bin\Debug\AutoArm.pdb" />
    <Content Include="netlify\constants.js" />
    <Content Include="netlify\index.html" />
    <Content Include="Languages\English\Keyed\AutoArm.xml" />
    <Content Include="netlify\styles.css" />
    <Content Include="netlify\weapons-data.js" />
    <Content Include="obj\Debug\AutoArm.csproj.FileListAbsolute.txt" />
    <Content Include="obj\Debug\AutoArm.dll" />
    <Content Include="obj\Debug\AutoArm.pdb" />
    <Content Include="Patches\BodyPartWeapons.xml" />
  </ItemGroup>
  <ItemGroup>
    <None Include="obj\Debug\AutoArm.csproj.AssemblyReference.cache" />
    <None Include="obj\Debug\AutoArm.csproj.CoreCompileInputs.cache" />
    <None Include="obj\Debug\DesignTimeResolveAssemblyReferencesInput.cache" />
    <None Include="obj\Release\AutoArm.csproj.AssemblyReference.cache" />
    <None Include="README.md" />
    <None Include="Source\Compatibility\SimpleSidearms_Integration_Requirements.md" />
    <None Include="Source\TO-DO.md" />
  </ItemGroup>
  <ItemGroup>
    <Folder Include="bin\Release\" />
    <Folder Include="Defs\" />
    <Folder Include="obj\Debug\TempPE\" />
  </ItemGroup>
  <ItemGroup>
    <Analyzer Include="..\packages\StyleCop.Analyzers.1.1.118\analyzers\dotnet\cs\StyleCop.Analyzers.CodeFixes.dll" />
    <Analyzer Include="..\packages\StyleCop.Analyzers.1.1.118\analyzers\dotnet\cs\StyleCop.Analyzers.dll" />
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- Pre- & Post-build events (works in VS and VS Code) -->
  <PropertyGroup>
    <!-- PRE-BUILD: generates Source\Definitions\Constants.cs -->
    <PreBuildEvent>
      cd "$(SolutionDir)" &amp;&amp; powershell -ExecutionPolicy Bypass -File "extract-constants.ps1"
    </PreBuildEvent>
    <!-- POST-BUILD: deploy compiled mod into RimWorld Mods folder -->
    <PostBuildEvent><![CDATA[
@echo off
setlocal enabledelayedexpansion

rem ── Paths
set "SRC=$(ProjectDir)"
set "DST=C:\Program Files (x86)\Steam\steamapps\common\RimWorld\Mods\AutoArm"

echo ========================================
echo AutoArm Mod Deployment Script
echo ========================================
echo Source: %SRC%
echo Destination: %DST%
echo.

rem Ensure destination hierarchy
if not exist "%DST%" mkdir "%DST%"
if not exist "%DST%\Assemblies" mkdir "%DST%\Assemblies"

rem Copy content folders
for %%F in (About Defs Patches Languages Textures Sounds) do (
    if exist "%SRC%\%%F" (
        echo Copying %%F...
        xcopy "%SRC%\%%F\*" "%DST%\%%F\" /E /I /Y /Q
    )
)

rem Replace DLL / PDB
for %%F in (AutoArm.dll AutoArm.pdb) do (
    if exist "%DST%\Assemblies\%%F" del /F /Q "%DST%\Assemblies\%%F"
    if exist "%SRC%\bin\$(Configuration)\%%F" (
        copy /Y "%SRC%\bin\$(Configuration)\%%F" "%DST%\Assemblies\%%F"
    )
)

rem Misc assets
for %%F in (preview.png thumbnail.png README.md LICENSE) do (
    if exist "%%SRC%%\%%F" copy /Y "%%SRC%%\%%F" "%%DST%%\%%F" >nul
)

echo.
echo Deployment Complete!
rem ---- removed problematic IF / FOR diagnostics ----
rem They caused “... was unexpected at this time” when the
rem path contained “(x86)”.
echo.
exit /b 0
      ]]></PostBuildEvent>
  </PropertyGroup>
</Project>